<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Manage Modules - AMP Digital</title>

  <!-- Bootstrap core CSS -->
  <link href="/sbadmin/css/bootstrap.css" rel="stylesheet">
    <link href="/faicons/css/all.css" rel="stylesheet"> <!--load all styles -->

  <!-- Add custom CSS here -->
  <link href="/sbadmin/css/sb-admin.css" rel="stylesheet">
  <link rel="stylesheet" href="/sbadmin/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.14.30/css/bootstrap-datetimepicker.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
  <!--<link href="/css/style.css" rel="stylesheet">-->
  <!--<link rel="stylesheet" href="/css/default.css" id="option_color">-->
  <!-- Page Specific CSS -->
  <!--<link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.4.3.min.css">-->
  <style>
    table a{
      cursor: pointer;
    }
    .popover{
      z-index:1000000;
    }
  </style>
</head>

<body class="mainContent">
<!-- Modal -->
<div id="addNewCourseModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header bg-color-1">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 style="color: black;" class="modal-title">Add New Course</h4>
      </div>
      <div class="modal-body addNewCourse">
        <div class="homeContactContent">
          <div class="row">
            <div class="col-sm-6 col-xs-12">
              <div class="form-group">
                <input type="text" class="form-control border-color-1" id="newcourseinput" placeholder="Course Name">
              </div>
            </div>
            <div class="col-xs-12">
              <div class="form-group">
                <textarea id="newcourseprojects" class="form-control border-color-2" placeholder="Course Objective"></textarea>
              </div>
            </div>
            <div class="col-xs-12">
              <div class="form-group">
                <textarea id="newcourseprojects" class="form-control border-color-3" placeholder="Course Projects"></textarea>
              </div>
            </div>
            <div class="col-sm-12 col-xs-12">
              <div class="form-group">
                <input type="text" class="form-control border-color-4" id="newcourseduration" placeholder="Course Duration">
              </div>
            </div>
            <div class="col-xs-12">
              <div class="form-group">
                <textarea id="newcoursetargetaudience" class="form-control border-color-5" placeholder="Target Audience"></textarea>
              </div>
            </div>
            <div class="col-sm-12 col-xs-12">
              <div class="form-group">
                <input type="text" class="form-control border-color-1" id="newcourserequirements" placeholder="Tools/Requirements">
              </div>
            </div>
            <div class="col-xs-12">
              <div class="formBtnArea">
                <button id="addnewcourse" class="btn btn-primary">Add Course</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

<div id="wrapper">

  <!-- Sidebar -->
  <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/admin">AMP Digital Admin Panel</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav side-nav">
        <li><a href="/admin"><i class="fa fa-dashboard"></i> Dashboard</a></li>
        <li ><a  href="/manage/jobs"><i class="fa fa-table"></i> Manage Jobs</a></li>  
            <li><a  href="manage/buddingarketerapplications"><i class="fa fa-table"></i> Budding marketer applications</a></li>
          <li><a href="/manage-coupons"><i class="fa fa-table"></i> Manage Coupon Codes</a></li>

        
        <li class="active"><a  href="/courses/manage"><i class="fa fa-table"></i> Manage Courses</a></li>
          <li><a href="/manage/forum"><i class="fa fa-money"></i> Manage Forums</a></li><li><a href="/submissions"><i class="fa fa-money"></i> Manage Submissions</a></li>
          <li><a href="/manage/webinarattendees"><i class="fa fa-users"></i> Manage Webinar Attendees</a></li>

        <li><a href="/blogs/categories/manage"><i class="fa fa-table"></i> Manage Blog Categories</a></li><li><a href="/blogs/manage"><i class="fa fa-table"></i> Manage Blogs</a></li><li><a href="/manage/webinar"><i class="fa fa-table"></i> Manage Webinar</a></li><li><a href="/manage/team"><i class="fa fa-table"></i> Manage Team</a></li>


                    <li ><a href="/manage/bookdownloads"><i class="fa fa-table"></i> Manage Book Downloads</a></li>

<li><a href="payments/couponstats"><i class="fa fa-table"></i> Referral/Promotional Programs</a></li>
<li><a href="/quizes"><i class="fa fa-table"></i> Manage Quizes</a></li>
        <li class=""><a href="/quizreport"><i class="fa fa-bar-chart-o"></i> Course Stats</a></li>

        <!--<li><a href="forms.html"><i class="fa fa-edit"></i> Forms</a></li>
        <li><a href="typography.html"><i class="fa fa-font"></i> Typography</a></li>
        <li><a href="bootstrap-elements.html"><i class="fa fa-desktop"></i> Bootstrap Elements</a></li>
        <li><a href="bootstrap-grid.html"><i class="fa fa-wrench"></i> Bootstrap Grid</a></li>
        <li><a href="blank-page.html"><i class="fa fa-file"></i> Blank Page</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-caret-square-o-down"></i> Dropdown <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="#">Dropdown Item</a></li>
            <li><a href="#">Another Item</a></li>
            <li><a href="#">Third Item</a></li>
            <li><a href="#">Last Item</a></li>
          </ul>
        </li>-->
      </ul>

      <ul class="nav navbar-nav navbar-right navbar-user">
        <!--<li class="dropdown messages-dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i> Messages <span class="badge">7</span> <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li class="dropdown-header">7 New Messages</li>
            <li class="message-preview">
              <a href="#">
                <span class="avatar"><img src="http://placehold.it/50x50"></span>
                <span class="name">John Smith:</span>
                <span class="message">Hey there, I wanted to ask you something...</span>
                <span class="time"><i class="fa fa-clock-o"></i> 4:34 PM</span>
              </a>
            </li>
            <li class="divider"></li>
            <li class="message-preview">
              <a href="#">
                <span class="avatar"><img src="http://placehold.it/50x50"></span>
                <span class="name">John Smith:</span>
                <span class="message">Hey there, I wanted to ask you something...</span>
                <span class="time"><i class="fa fa-clock-o"></i> 4:34 PM</span>
              </a>
            </li>
            <li class="divider"></li>
            <li class="message-preview">
              <a href="#">
                <span class="avatar"><img src="http://placehold.it/50x50"></span>
                <span class="name">John Smith:</span>
                <span class="message">Hey there, I wanted to ask you something...</span>
                <span class="time"><i class="fa fa-clock-o"></i> 4:34 PM</span>
              </a>
            </li>
            <li class="divider"></li>
            <li><a href="#">View Inbox <span class="badge">7</span></a></li>
          </ul>
        </li>
        <li class="dropdown alerts-dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i> Alerts <span class="badge">3</span> <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="#">Default <span class="label label-default">Default</span></a></li>
            <li><a href="#">Primary <span class="label label-primary">Primary</span></a></li>
            <li><a href="#">Success <span class="label label-success">Success</span></a></li>
            <li><a href="#">Info <span class="label label-info">Info</span></a></li>
            <li><a href="#">Warning <span class="label label-warning">Warning</span></a></li>
            <li><a href="#">Danger <span class="label label-danger">Danger</span></a></li>
            <li class="divider"></li>
            <li><a href="#">View All</a></li>
          </ul>
        </li>-->
        <li class="dropdown user-dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> <%=email%> <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <!--<li><a href="#"><i class="fa fa-user"></i> Profile</a></li>
            <li><a href="#"><i class="fa fa-envelope"></i> Inbox <span class="badge">7</span></a></li>
            <li><a href="#"><i class="fa fa-gear"></i> Settings</a></li>
            <li class="divider"></li>-->
            <li><a href="/logout"><i class="fa fa-power-off"></i> Log Out</a></li>
          </ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </nav>

  <div id="page-wrapper">
    <div class="row">
      <div  class="col-lg-12">
        <ol class="breadcrumb">
          <li class="active"><i class="fa fa-dashboard"></i> Dashboard</li>
          <li class="active"></i> Manage Forums</li>
        </ol>
      </div>
    </div>
    <div class="">
      <div class="tab-content">
        <div class="">
          <input type="text" id="newmodulenameinput" placeholder="Add New Module">
          <input type="text" id="newmoduledescriptioninput" placeholder="Module Description">
          <input type="text" id="newmoduleimageinput" placeholder="Module Image">
          <input type="number" id="newmodulenoinput" placeholder="Module Order">
          <button class="btn btn-primary btn-lg" id="addnewmodule">Add</button>
          <table class="cell-border compact stripe hover row-border">
            <thead>
            <tr>
              <th>Module Name</th>
              <th>Module ID</th>
              <th>Module Description</th>
              <th>Image</th>
              <th>Upload/Edit Image</th>
              <th>Module Order</th>
              <th>Module Created on</th>
              <th>Action</th>
            </tr>
            </thead>
            <tbody>
            <%for(var i = 0; i < forums.length; i++){
              var docs = forums;%>
            <tr>
              <td>
                <a class="updatemodule approtitle" id="course_name" data-type="textarea" data-pk="<%= docs[i]['_id'] %>" data-url="/updateforumname" data-title="Enter title"><%= docs[i]['module_name'] %></a>
              </td>
              <td>
                <a class="updatemodule approtitle" id="course_name" data-type="textarea" data-pk="<%= docs[i]['_id'] %>" data-url="/updateforumid" data-title="Enter module id"><%= docs[i]['module_id'] %></a>
              </td>
              <td>
                <a class="updatemodule2 approtitle" id="course_name" data-type="textarea" data-pk="<%= docs[i]['_id'] %>" data-url="/updateforumdescription" data-title="Enter description"><%= docs[i]['module_description'] %></a>
              </td>
              <td>
                  <%if(docs[i]['module_image'] && docs[i]['module_image'].split('?')){%>
                <a href="<%=docs[i]['module_image'].split('?')[0]%>"><i class="fa fa-image"></i></a>
                  <%}else{%>
                <span class="label label-info"><i>No Image Uploaded</i></span>
                  <%}%>
              </td>
              <td>
                <!--<a class="updatemodule approtitle" id="course_name" data-type="textarea" data-pk="<%= docs[i]['_id'] %>" data-url="/updatemoduleimage" data-title="Enter image"><%= docs[i]['module_image'] %></a>-->
                <form enctype="multipart/form-data" class="imagesubmitform" action="/uploadons4forum" method="POST" target="_blank">
                  <label>
                    <input name="moduleid"  type="hidden" value="<%=docs[i]['_id']%>">
                    Browse <input name="avatar" class="imagetosubmit" type="file" hidden>
                  </label>
                  <button class="btn btn-xs btn-primary imagesubmitformbtn" type="submit">Submit</button>
                </form>
              </td>
              <td>
                <a class="updatemodule approtitle" id="course_name" data-type="textarea" data-pk="<%= docs[i]['_id'] %>" data-url="/updatemoduleorder" data-title="Enter title"><%= docs[i]['module_order'] %></a>
              </td>
              <td><%=moment(forums[i]['module_createdon']).format( 'MMM-DD-YYYY')%></td>
              <td><a class="removemodule" data-module_id="<%=forums[i]['_id']%>" href=""><i class="fa fa-trash-o"></i>Remove</a></td>
            </tr>
            <%}%>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div><!-- /#wrapper -->

<!-- JavaScript -->
<script src="/sbadmin/js/jquery-1.10.2.js"></script>
<script src="/sbadmin/js/bootstrap.js"></script>

<!-- Page Specific Plugins -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<!--<script src="http://cdn.oesmith.co.uk/morris-0.4.3.min.js"></script>-->
<!--<script src="/sbadmin/js/morris/chart-data-morris.js"></script>-->
<script src="/sbadmin/js/tablesorter/jquery.tablesorter.js"></script>
<script src="/sbadmin/js/tablesorter/tables.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script src="https://momentjs.com/downloads/moment-with-locales.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.14.30/js/bootstrap-datetimepicker.min.js"></script>
<!--Confirm.js alerts Plugin-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>
<link href="/css/bootstrap-editable.css" rel="stylesheet"/>
<script src="/js/bootstrap-editable.min.js"></script>
<!--Confirm.js alerts Plugin-->
<script type="text/javascript">
    $(document).ready(function () {
      $.fn.editableform.buttons =
  '<button type="submit" class="btn btn-primary btn-sm editable-submit">'+
    '<i class="fa fa-fw fa-check"></i>'+
  '</button>'+
  '<button type="button" class="btn btn-default btn-sm editable-cancel">'+
    '<i class="fa fa-fw fa-times"></i>'+
  '</button>';
        $('table').DataTable({"order": [[ 1, "asc" ]],
            "paging": false,
            "initComplete": function(settings, json) {
                $('.updatemodule').editable({tpl: '<textarea maxlength="10000"></textarea>', success: function(response, newValue) {

                    }});
                $('.updatemodule2').editable({tpl: '<textarea maxlength="200"></textarea>', success: function(response, newValue) {

                    }});
            }});

        //Handler to add a new module
        $('#addnewmodule').on('click', function () {
            var module_name = $('#newmodulenameinput').val();
            var module_description = $('#newmoduledescriptioninput').val();
            var module_image = $('#newmoduleimageinput').val();
            var module_order = $('#newmodulenoinput').val();
            var module_course_id = $('#newmodulecourseid').val();
            if(module_name.trim()!=='' && module_order.trim()!==''){
                $.ajax({
                    type: "POST",
                    url: '/addmodule',
                    data: {
                        module_name: module_name,
                        module_description: module_description,
                        module_image: module_image,
                        module_order: module_order,
                        course_id: module_course_id
                    },
                    success: function(result){
                        location.reload();
                    }
                });
            }
            else{
                alert('Kindly fill all inputs');
            }
        });

        //Handler to navigate to the module's topics
        $('.module_topics').on('click', function () {
            var moduleid = $(this).data('moduleid');
            var courseid = $('.mainContent').data('courseid');
            window.location = '/manage/topics/'+courseid+'/'+moduleid;
        });

        $('.removemodule').on('click', function (e) {
            e.preventDefault();
            var module_id = $(this).data('module_id');
            $.confirm({
                title: 'Confirm!',
                content: 'Are you sure you want to delete the module?',
                buttons: {
                    confirm: function () {
                        $.ajax({
                            type: "PUT",
                            url: '/removemodule',
                            data: {
                                module_id: module_id
                            },
                            success: function(result){
                                $.alert('Module Removed Successfully!');
                                location.reload();
                            }
                        });
                    },
                    cancel: function () {

                    },
                }
            });
        });
    });
</script>
</body>
</html>
